<html xmlns:th="http://www.thymeleaf.org">
<link rel="stylesheet" href="/css/comunityDetail.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<th:block th:replace="~{/include/baseLayout :: setContent( ~{ :: .wrap} ) }">

<div class="wrap">
	 <div class="container-fluid py-4">
      <div class="container-title">커뮤니티</div>
      <div class="content-wrap">
        <div class="content-title">자유로운 글</div>
        <div class="title-box">
          <span>
            <span class="content-writer">작성자:&nbsp;</span>
            [[${vo.userId}]]
          </span>
          <span>
            <span class="content-regdate">작성일:</span>
          	[[${vo.pst_regdate}]]
          </span>
          <span>
            <span class="content-hit">조회수:</span>
            [[${vo.inq_cnt}]]
          </span>
          <span>
            <span class="content-reply">댓글수:</span>
            아직 구현 안함
          </span>
        </div>
        <div class="content-box">
          <textarea name="" id="textarea" cols="30" rows="10" readonly>[[${vo.pst_ttl_cn}]]</textarea>
        </div>
      </div>
      <div class="uploadFile-box">
      	<h4>업로드 한 파일</h4>
      	<div class="uploadFile">
      	<th:block th:each="uploadvo : ${list} ">
      	
      	<span th:onclick="|location.href='@{attachment(filepath=${uploadvo.filepath},uuid=${uploadvo.uuid},filename=${uploadvo.filename})}'|" class="filename">
      	<span class="material-symbols-outlined">
		download
		</span>
      	[[${uploadvo.filename}]]</span>
      	</th:block>
      	</div>
      </div>
      <div class="reply-wrap"> 
        <span>댓글</span>
          <div class="reply-box">
            <input type="text" class="reply-content">
          </div>
          <button type="button" class="reply-reg">등록</button>
          <div class="reply">
            <ul>
              <li>
                <img src="" alt=" " />
                <span class="reply-writer">김단수</span>
                <span class="reply-date">2024-01-01</span>
                <p>바둑 그렇게 하는거아닌데</p>
                <div class="reply-child">
                  <form>
                    <input type="text" class="child-content">
                    <input type="submit" value="댓글달기" class="child-reg">
                  </form>
                </div>
                <ul>
                  <li>
                    <img src="" alt=" " />
                  <span class="reply-writer">김바둑</span>
                  <span class="reply-date">2024-01-01</span>
                  <p>대댓글 할지 말지 모르겠어요</p>
                  </li>
                  <li>
                    <img src="" alt=" " />
                  <span class="reply-writer">김고수</span>
                  <span class="reply-date">2024-01-01</span>
                  <p>대댓글만 할게요</p>
                  </li>
                </ul>
              </li>
              <li>
                <img src="" alt=" " />
                <span class="reply-writer">김바둑</span>
                <span class="reply-date">2024-01-01</span>
                <p>바둑 그렇게 하세요</p>
                <div class="reply-child">
                  <form>
                    <input type="text" class="child-content">
                    <input type="submit" value="댓글달기" class="child-reg">
                  </form>
                </div>
                <ul>
                </ul>
              </li>
            </ul>
           </div>
        </form>
      </div>
    </div>
    <div class="button-wrap">
      <button type="button" id="changeBtn" th:onclick="|location.href='@{comunityModify(pst_ttl_no=${vo.pst_ttl_no})}'|">수정하기</button>
      <button type="button" id="deleteBtn" th:onclick="|location.href='@{comunityDelete(pst_ttl_no=${vo.pst_ttl_no})}'|">삭제하기</button>
      <button type="button" id="backBtn" th:onclick="|location.href='@{comunityList}'|">목륵으로</button>
    </div>
    </div>
</th:block>

 <script>
      
      const DEFAULT_HEIGHT = 300; // textarea 기본 height

      const $textarea = document.querySelector('#textarea');

      $textarea.oninput = (event) => {
      const $target = event.target;

      $target.style.height = 0;

      $target.style.height = DEFAULT_HEIGHT + $target.scrollHeight + 'px';

    };
    
    </script>
    
    <script th:inline="javascript">
   
    var reply_cn = document.querySelector(".reply-content");
    
    
    
    $(".reply-reg").click(function(){
    	
    const params = {
            pst_ttl_no : '[[${vo.pst_ttl_no}]]',
            reply_cn : reply_cn.value,
            userId : '[[${vo.userId}]]'
        }
    
    	$.ajax({
    		url:"http://localhost:8282/user/replyAdd",
    		type:"post",
    		contentType:"application/json",
    		dataType:"text",
    		data:JSON.stringify(params),
    		success : function(response){
    			console.log(response);
    		},
    		error : function(request,status,error){
    			console.log(error);
    		}
    	})
    })
    </script>
</html>
